(speechvision) D:\POS\arch2_keras>python asr_trafo_plus_vae.py
2.7.0
1
True
2024-09-20 07:57:17.515618: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-09-20 07:57:17.601784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5592 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3060 Ti, pci bus id: 0000:01:00.0, compute capability: 8.6
Camada decodificadora 0 congelada: False
Camada decodificadora 1 congelada: False
Componente FFN da camada decodificadora 2 congelado: False
Camada decodificadora 2 congelada: False
Epoch 1/200
Forma da entrada no encoder: (None, 64, 40000)
Forma da saída do encoder: (None, 8, 200)
Forma da entrada no encoder: (None, 64, 40000)
Forma da saída do encoder: (None, 8, 200)
2024-09-20 07:58:10.558919: I tensorflow/stream_executor/cuda/cuda_blas.cc:1774] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2024-09-20 07:58:10.569285: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8905
 1/200 [..............................] - ETA: 1:10:43 - loss: 0.02532024-09-20 07:58:24.199493: W tensorflow/core/framework/op_kernel.cc:1733] INVALID_ARGUMENT: TypeError: `generator` yielded an element of shape (43, 200, 200, 1) where an element of shape (64, 200, 200, 1) was expected.
Traceback (most recent call last):

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\ops\script_ops.py", line 275, in __call__
    ret = func(*args)

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 649, in wrapper
    return func(*args, **kwargs)

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 1035, in generator_py_func
    raise TypeError(

TypeError: `generator` yielded an element of shape (43, 200, 200, 1) where an element of shape (64, 200, 200, 1) was expected.


Traceback (most recent call last):
  File "D:\POS\arch2_keras\asr_trafo_plus_vae.py", line 609, in <module>
    history = model.fit(ds, validation_data=val_ds, epochs=epocas, steps_per_epoch=steps_per_epoch,  callbacks=[tensorboard_callback, checkpoint])
  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\keras\utils\traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\eager\execute.py", line 58, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT:  TypeError: `generator` yielded an element of shape (43, 200, 200, 1) where an element of shape (64, 200, 200, 1) was expected.
Traceback (most recent call last):

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\ops\script_ops.py", line 275, in __call__
    ret = func(*args)

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 649, in wrapper
    return func(*args, **kwargs)

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 1035, in generator_py_func
    raise TypeError(

TypeError: `generator` yielded an element of shape (43, 200, 200, 1) where an element of shape (64, 200, 200, 1) was expected.


         [[{{node PyFunc}}]]
         [[IteratorGetNext]]
         [[transformer/Shape/_4]]
  (1) INVALID_ARGUMENT:  TypeError: `generator` yielded an element of shape (43, 200, 200, 1) where an element of shape (64, 200, 200, 1) was expected.
Traceback (most recent call last):

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\ops\script_ops.py", line 275, in __call__
    ret = func(*args)

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 649, in wrapper
    return func(*args, **kwargs)

  File "C:\Users\Ricardo\miniconda3\envs\speechvision\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 1035, in generator_py_func
    raise TypeError(

TypeError: `generator` yielded an element of shape (43, 200, 200, 1) where an element of shape (64, 200, 200, 1) was expected.


         [[{{node PyFunc}}]]
         [[IteratorGetNext]]
0 successful operations.
0 derived errors ignored. [Op:__inference_train_function_14177]

Function call stack:
train_function -> train_function
